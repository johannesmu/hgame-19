window.addEventListener("load",(function(){resizeCanvas(),initGame(),readScore()})),window.addEventListener("unload",(function(){saveScore()})),window.addEventListener("reload",(function(){})),window.addEventListener("resize",resizeCanvas,!1),window.addEventListener("keydown",onKeyDown),window.addEventListener("keyup",onKeyUp);var stage=new createjs.Stage("gamecanvas");createjs.Touch.enable(stage);var width,height,player,playerheight,tween,mouseisdown=!1,timer=createjs.Ticker,scale=.8,isalive=!0,score=0,highscore=0,restart=!1,interval=250,obspeed=2,obstacles=new Array;function resizeCanvas(){canvas=document.getElementById("gamecanvas"),container=document.getElementById("gamecontainer"),ww=container.offsetWidth,wh=container.offsetHeight,canvas.width=container.offsetWidth,canvas.height=wh-50,width=canvas.width,height=canvas.height,stage.update(),width<=480&&(scale=.6)}function initGame(){time=setRestart("get")-(new Date).getTime(),time>2e4&&showMenu(!0,"start"),timer.on("tick",onTick,this),timer.setFPS(60),stage.addEventListener("stagemousedown",onStageClick),stage.on("stagemouseup",onStageMouseUp),setupPlayer(),intializeObstacles()}function resetGame(){"success"==setRestart("set")&&window.location.reload()}function setRestart(e){if("set"==e)try{return window.localStorage.setItem("timestamp",(new Date).getTime()),"success"}catch(e){return"error"}else if("get"==e)try{return time=window.localStorage.getItem("timestamp"),time}catch(e){return"error"}}function intializeObstacles(){for(i=0;i<obslist.length;i++)obs=new createjs.Bitmap(obsfolder+obslist[i]),obs.scaleX=2*scale,obs.scaleY=2*scale,get=obs.getTransformedBounds()}function onStageClick(e){isalive&&(mouseisdown=!0)}function onStageMouseUp(){mouseisdown=!1}function onKeyDown(e){32==e.keyCode&&(mouseisdown=!0)}function onKeyUp(){mouseisdown=!1}function setupPlayer(){var e=new createjs.SpriteSheet({images:["assets/sprites/bird.png"],frames:{width:200,height:120},animations:{fly:[0,3],dead:[5]}}),t=new createjs.Sprite(e,"fly");(player=new createjs.Sprite(e,t)).x=.3*width,player.y=height/2,player.scaleX=scale,player.scaleY=scale,player.regX=100,player.regY=80,player.gotoAndPlay("fly"),player.name="player",stage.addChild(player),stage.update()}function onTick(){0==timer.getPaused()&&((player.y<60||player.y>=height-50)&&killPlayer(),tween=0==mouseisdown?TweenLite.to(player,3,{y:height,ease:Power0.easeIn}):TweenLite.to(player,3,{y:0,ease:Power0.easeIn}),manageObstacles(),showScore()),stage.update(),moveBackground("gamebg")}function killPlayer(){if(1==isalive){player.gotoAndStop("dead"),isalive=!1,playerheight=player.getTransformedBounds().height,stopheight=playerheight+150;window.setTimeout((function(){stopGame()}),3e3)}}function stopGame(){saveScore(),timer.setPaused(!0),showMenu(!0,"Restart")}function randomNumber(e,t){return rn=Math.random()*e,1==t?Math.floor(rn):rn}function createObstacle(){return num=randomNumber(obslist.length-1,!0),size=1.8*scale,obs=new createjs.Bitmap(obsfolder+obslist[num]),obs.scaleX=size,obs.scaleY=size,ypos=height-obs.getTransformedBounds().height,space=randomNumber(ypos,!1),obs.y=space,obs.name="item",obs}function manageObstacles(){if(timer.getTicks()%interval==0)obstacle=createObstacle(),obstacle.x=width+1,obstacles.push(obstacle),stage.addChildAt(obstacle,0);else if(obstacles.length>0)for(i=0;i<obstacles.length;i++)obs=obstacles[i],pos=obs.x,obswidth=obs.getTransformedBounds().width,pos>width-2*width&&1==isalive?(obstacles[i].x=pos-obspeed,obstacles[i].x<=player.x&&"item"==obs.name&&1==isalive&&(addScore(),obs.name="remove")):pos<-1*obswidth&&stage.removeChild(obstacles.shift()),0!=checkCollision(player,obs)&&killPlayer()}function showMenu(e,t){1==e?(document.getElementById("restartbtn").addEventListener("mousedown",(function(){resetGame()})),document.getElementById("restartbtn").innerHTML=t,document.getElementById("restart").style.visibility="visible"):document.getElementById("restart").style.visibility="hidden"}function checkCollision(e,t){return ndgmr.checkPixelCollision(e,t,0)}function showScore(){document.getElementById("score").innerHTML=score,document.getElementById("highscore").innerHTML="highscore="+highscore}function addScore(){switch(++score>=highscore&&(highscore=score),score){case score>10:interval=200;break;case score>20:interval=150;break;case score>40:interval=120}showScore()}function saveScore(){try{window.localStorage.setItem("highest",highscore)}catch(e){console.log("error saving score "+e)}}function readScore(){try{localStorage.length>0&&(storedscore=window.localStorage.getItem("highest"),highscore=storedscore)}catch(e){console.log("error reading score "+e)}}obsfolder="assets/images/",obslist=["obs_tv.png","obs_radio.png","obs_camera.png","obs_light.png","obs_mic.png"];var bgposition=0;function moveBackground(e){if(timer.getTicks()%5==0){var t=(bgposition-=1)+"px 0px";document.getElementById(e).style.backgroundPosition=t}}document.addEventListener("deviceready",(function(){document.addEventListener("back",(function(){saveScore(),navigator.app.exitApp()}))}));
//# sourceMappingURL=maps/main.min.js.map
